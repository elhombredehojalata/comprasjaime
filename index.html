<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Compra de Equipos - JAIME</title>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("fecha").valueAsDate = new Date();
    });

    async function enviarFormulario(event) {
      event.preventDefault();

      const modelos = [];
      document.querySelectorAll(".modelo-grupo").forEach(grupo => {
        modelos.push({
          cantidad: grupo.querySelector(".cantidad").value,
          modelo: grupo.querySelector(".modelo").value,
          precio: grupo.querySelector(".precio").value
        });
      });

      const data = {
        fecha: document.getElementById("fecha").value,
        proveedor: document.getElementById("proveedor").value,
        modelos: modelos,
        monto: document.getElementById("monto").value
      };

      const response = await fetch("https://script.google.com/macros/s/AKfycbxSfKV9OtRCMlM_oajPFenYNK-N2R3g2-x2MUhKPEEuAYRmgX8361Mj-aexM1MEOZgx/exec", {
        method: "POST",
        body: JSON.stringify(data),
        headers: { "Content-Type": "application/json" }
      });

      if (response.ok) {
        document.getElementById("formulario").style.display = "none";
        document.getElementById("mensaje-confirmacion").style.display = "block";
      } else {
        alert("Error al enviar el formulario. Intenta nuevamente.");
      }
    }

    function agregarCamposExtra() {
      const contenedor = document.getElementById("modelos-contenedor");
      for (let i = 0; i < 3; i++) {
        const grupo = document.createElement("div");
        grupo.className = "modelo-grupo mb-4 flex gap-4";
        grupo.innerHTML = `
          <input type="number" placeholder="Cantidad" class="cantidad p-2 border rounded w-20 text-lg">
          <input type="text" placeholder="Modelo" class="modelo p-2 border rounded w-1/2 text-lg">
          <input type="number" placeholder="Precio" class="precio p-2 border rounded w-1/3 text-lg">
        `;
        contenedor.appendChild(grupo);
      }
    }
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900 text-lg">
  <div class="max-w-4xl mx-auto py-10 px-6">
    <h1 class="text-4xl font-bold text-center mb-8">üìù COMPRA DE EQUIPOS JAIME</h1>

    <form id="formulario" onsubmit="enviarFormulario(event)" class="space-y-6">
      <div>
        <label class="block font-semibold mb-1">Fecha:</label>
        <input type="date" id="fecha" class="w-full p-3 border rounded text-lg">
      </div>

      <div>
        <label class="block font-semibold mb-1">Proveedor:</label>
        <input type="text" id="proveedor" required class="w-full p-3 border rounded text-lg">
      </div>

      <div>
        <label class="block font-semibold mb-2">Modelos comprados:</label>
        <div id="modelos-contenedor" class="space-y-4">
          <!-- Grupo de modelos inicial -->
          <div class="modelo-grupo flex gap-4">
            <input type="number" placeholder="Cantidad" class="cantidad p-2 border rounded w-20 text-lg">
            <input type="text" placeholder="Modelo" class="modelo p-2 border rounded w-1/2 text-lg">
            <input type="number" placeholder="Precio" class="precio p-2 border rounded w-1/3 text-lg">
          </div>
          <div class="modelo-grupo flex gap-4">
            <input type="number" placeholder="Cantidad" class="cantidad p-2 border rounded w-20 text-lg">
            <input type="text" placeholder="Modelo" class="modelo p-2 border rounded w-1/2 text-lg">
            <input type="number" placeholder="Precio" class="precio p-2 border rounded w-1/3 text-lg">
          </div>
          <div class="modelo-grupo flex gap-4">
            <input type="number" placeholder="Cantidad" class="cantidad p-2 border rounded w-20 text-lg">
            <input type="text" placeholder="Modelo" class="modelo p-2 border rounded w-1/2 text-lg">
            <input type="number" placeholder="Precio" class="precio p-2 border rounded w-1/3 text-lg">
          </div>
          <div class="modelo-grupo flex gap-4">
            <input type="number" placeholder="Cantidad" class="cantidad p-2 border rounded w-20 text-lg">
            <input type="text" placeholder="Modelo" class="modelo p-2 border rounded w-1/2 text-lg">
            <input type="number" placeholder="Precio" class="precio p-2 border rounded w-1/3 text-lg">
          </div>
        </div>
        <div class="mt-4">
          <button type="button" onclick="agregarCamposExtra()" class="text-blue-600 font-semibold">‚ûï He comprado m√°s equipos</button>
        </div>
      </div>

      <div>
        <label class="block font-semibold mb-1">Monto total depositado al proveedor:</label>
        <input type="number" id="monto" required class="w-full p-3 border rounded text-lg">
      </div>

      <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white py-4 rounded-lg text-2xl font-bold transition">
        ‚úÖ ENVIAR
      </button>
    </form>

    <div id="mensaje-confirmacion" class="hidden text-center mt-10">
      <h2 class="text-3xl font-bold mb-4">‚úÖ ¬°Listo Jaime, tus compras han sido registradas!</h2>
      <p class="text-xl mb-6">Puedes ver tu lista de compras accediendo a la opci√≥n <strong>"MIS COMPRAS"</strong>.</p>
      <button onclick="location.reload()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded text-xl">OK</button>
    </div>
  </div>
</body>
</html>
